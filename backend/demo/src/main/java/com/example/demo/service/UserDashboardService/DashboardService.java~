package com.example.demo.service.UserDashboardService;


// service
// └── 📁 UserDashboardServce
//      ├── DashboardService.java            // Quản lý xử lý chính (giao tiếp với controller)
//      ├── DashboardUpdateService.java      // Xử lý cập nhật dashboard
//      ├── DashboardMetricsService.java     // Tính toán số liệu (basic, time-based)
//      ├── MilestoneService.java            // Tính mốc phần thưởng tiếp theo
//      └── TrackingHistoryService.java      // Trả về lịch sử tracking từng ngày


import com.example.demo.DTO.DashboardDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Map;

@Service
@RequiredArgsConstructor
public class DashboardService {

        private final DashboardUpdateService dashboardUpdateService;
        private final TrackingHistoryService trackingHistoryService;

        public ResponseEntity<DashboardDTO> getDashboard(Integer userId) {
            return dashboardUpdateService.getOrUpdateDashboard(userId);
        }

        public ResponseEntity<List<Map<String, Object>>> getTrackingHistory(Integer userId) {
            return trackingHistoryService.getHistory(userId);
        }

        public void handleDataUpdatedEvent(Integer userId) {
            dashboardUpdateService.forceUpdateDashboard(userId);
        }
}

